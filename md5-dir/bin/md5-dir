#!/usr/bin/perl
# vim: ts=2 sw=2 ft=perl
eval 'exec perl -x -wS $0 ${1+"$@"}'
  if 0;
$|++;
use common::sense;
use autodie;
use Nobody::Util;
our(@VERSION) = qw( 0 1 0 );

push(@ARGV,".") unless @ARGV;
our($pid);
sub status() {
    say STDERR $$, ":pid=$pid";
    @_=glob "/proc/$$/fd/*";
    @_=grep { -l } @_;
    say STDERR $$, ":", $_, " => ", readlink($_) for @_;
};
open(STDIN,"</dev/null");
my @find = ("find", "..");
for( qw( .git .svc CVS ) ) {
  push(@find, "-name", $_, qw( -prune -o ));
};
push(@find,qw( -type d -print ));
status;
$pid=open(STDIN,"|-", @find);
status;
